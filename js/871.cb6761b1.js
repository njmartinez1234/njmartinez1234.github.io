"use strict";(self["webpackChunkvue_login_signup_ui"]=self["webpackChunkvue_login_signup_ui"]||[]).push([[871],{5657:function(e,t,o){o.d(t,{Z:function(){return m}});var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-modal",{ref:"modal",attrs:{id:"modal-prevent-closing",centered:"",title:"User Confirmation"},on:{show:e.resetModal,hidden:e.resetModal,ok:e.handleOk}},[o("OverlayComponent",{attrs:{show:e.showOverlayConfirm}},[o("p",{staticClass:"my-4"},[e._v(" Please enter the confirmation code we sent to your email. ")]),o("form",{ref:"form",on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit.apply(null,arguments)}}},[o("b-form-group",{attrs:{"label-for":"name-input","invalid-feedback":e.invFeedbackTxt,state:e.codeState}},[o("b-form-input",{attrs:{id:"name-input",type:"number",state:e.codeState,required:"",size:"lg",placeholder:"Enter your code"},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1)],1)])],1)],1)},s=[],n=o(1801),r=o(8341),i={name:"ModalConfirmation",components:{OverlayComponent:r.Z},props:{email:{type:String,required:!0}},data(){return{code:"",codeState:null,invFeedbackTxt:"Code is required",showOverlayConfirm:!1}},methods:{checkFormValidity(){const e=this.$refs.form.checkValidity();return this.codeState=e,e},resetModal(){this.code="",this.codeState=null},handleOk(e){e.preventDefault(),this.handleSubmit()},async handleSubmit(){if(this.checkFormValidity()){this.showOverlayConfirm=!this.showOverlayConfirm;try{const e=await n.Z.confirmation(this.email,this.code);this.confirmationMsgBox(e.data.message,"Success","success","OK")}catch(e){return this.confirmationMsgBox(e.response.data.message,"Error","danger","Retry"),void(this.showOverlayConfirm=!this.showOverlayConfirm)}}},confirmationMsgBox(e,t,o,a){this.$bvModal.msgBoxOk(e,{title:t,size:"sm",buttonSize:"sm",okTitle:a,okVariant:o,cancelTitle:"NO",headerClass:"p-2 border-bottom-0",footerClass:"p-2 border-top-0",centered:!0}).then((e=>{"success"===o&&e&&(this.resetModal,this.$router.push("/"),this.showOverlayConfirm=!this.showOverlayConfirm)})).catch((e=>{}))}}},l=i,d=o(1001),c=(0,d.Z)(l,a,s,!1,null,null,null),m=c.exports},6098:function(e,t,o){o.d(t,{Z:function(){return d}});var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("b-modal",{attrs:{id:"modal-center",centered:""},model:{value:e.isOpen,callback:function(t){e.isOpen=t},expression:"isOpen"}},[o("p",[e._v(e._s(e.text))])])},s=[],n={props:{value:{type:Boolean,required:!0},text:{type:String,required:!0}},computed:{isOpen:{get(){return this.value},set(e){this.$emit("input",e)}}}},r=n,i=o(1001),l=(0,i.Z)(r,a,s,!1,null,null,null),d=l.exports},2871:function(e,t,o){o.r(t),o.d(t,{default:function(){return p}});var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("OverlayComponent",{attrs:{show:e.loggedIn}},[e.loggedIn?e._e():o("div",{staticClass:"inner-block"},[o("div",[o("ModalConfirm",{ref:"modalConfirmation",attrs:{email:e.email}}),o("ModalDialog",{attrs:{text:e.modalText},model:{value:e.isModalOpen,callback:function(t){e.isModalOpen=t},expression:"isModalOpen"}})],1),o("div",{staticClass:"container"},[o("div",{staticClass:"row justify-content-center"},[o("div",{staticClass:"col-md-12"},[o("h1",{staticClass:"text-center"},[e._v("Login")]),o("OverlayComponent",{attrs:{show:e.showOverlaySignIn}},[o("form",{staticClass:"mt-4",on:{submit:function(t){return t.preventDefault(),e.login.apply(null,arguments)}}},[o("div",{staticClass:"form-group fixed-form-margin"},[o("label",{attrs:{for:"email"}},[e._v("Email:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"form-control",attrs:{type:"email",id:"email",required:"",placeholder:"user@mail.com"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}})]),o("div",{staticClass:"form-group fixed-form-margin"},[o("label",{attrs:{for:"password"}},[e._v("Password:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password",id:"password",placeholder:"Password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),e.error?o("p",{staticClass:"text-danger"},[e._v(" Has introducido mal el email o la contraseña. ")]):e._e(),o("button",{staticClass:"btn btn-outline-primary fixed-form-margin",attrs:{type:"submit"}},[e._v("Login")])]),o("p",{staticClass:"mt-3"},[e._v(" ¿Don't have an account? "),o("router-link",{attrs:{to:"/signup"}},[e._v("Signup")])],1)])],1)])])])])},s=[],n=o(1801),r=o(6098),i=o(8341),l=o(5657),d={components:{ModalDialog:r.Z,OverlayComponent:i.Z,ModalConfirm:l.Z},data:()=>({email:"",password:"",error:!1,showOverlaySignIn:!1,showOverlayIsLogedIn:!1,modalText:"",isModalOpen:!1}),beforeRouteEnter(e,t,o){const a="true"===localStorage.getItem("loggedIn"),s="true"===localStorage.getItem("showOverlaySignIn");a&&!s?o("/operations"):o()},computed:{loggedIn(){return"true"===localStorage.getItem("loggedIn")}},methods:{login(){this.showOverlaySignIn=!this.showOverlaySignIn,n.Z.signin(this.email,this.password).then((e=>{console.log(e),this.$eventBus.loggedIn="true",this.$eventBus.token=e.data.access_token,this.$eventBus.userBalance=e.data.user.balance,this.$eventBus.userName=e.data.user.username,this.$router.push("/operations")})).catch((e=>{"User is not confirmed. Please confirm your account."===e.response.data.message?this.$bvModal.msgBoxConfirm([e.response.data.message],{buttonSize:"sm",centered:!0,size:"sm"}).then((e=>{e&&this.$refs.modalConfirmation.$refs.modal.show()})):this.openModal(e.response.data.message)})).finally((()=>{this.showOverlaySignIn=!this.showOverlaySignIn}))},openModal(e){this.isModalOpen=!0,this.modalText=e}}},c=d,m=o(1001),u=(0,m.Z)(c,a,s,!1,null,null,null),p=u.exports}}]);
//# sourceMappingURL=871.cb6761b1.js.map